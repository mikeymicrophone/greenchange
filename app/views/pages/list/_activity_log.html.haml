-# =begin
-# 
-# This partial takes an array of pages and displays them grouped by
-# when they were updated. For example, all the pages updated yesterday
-# are grouped together.
-# 
-# Local variables that can be passed in:
-# 
-# * :pages -- an array of pages to be shown. Must be storted by updated_at
-# * :style -- an symbol that tells this partial how to look.
-# 
-# Available styles:
-# 
-# * :normal -- the default
-# * :brief_no_group -- a shorter display, with no group info.
-# 
-# =end
- today = []
- yesterday = []
- week = []
- later = []
- pages ||= @pages
- style ||= :normal
- 
- #pages = array_of_pages(pages)
- page = pages.shift
- 
- while page and after_local_day_start?(page.updated_at)
  - today << page
  - page = pages.shift

- while page and after_local_yesterday_start?(page.updated_at)
  - yesterday << page
  - page = pages.shift

- while page and after_local_week_start?(page.updated_at)
  - week << page
  - page = pages.shift

- while page
  - later << page
  - page = pages.shift

.activity
  - if today.any?
    -#%tr
      %th{ :colspan => "30" }
    %h4.landing
      Today
    - today.each do |page|
      = render :partial => 'pages/list/activity_entry', :locals => {:page => page, :style => style}
  -#
    - if yesterday.any?
    - reset_cycle 'activity_entry_cycle'
    %tr
      %th{ :colspan => "30" }
        %h4.landing
          Yesterday
    - yesterday.each do |page|
    = render :partial => 'pages/list/activity_entry', :locals => {:page => page, :style => style}
    - end
    - end
  - if week.any?
    - reset_cycle 'activity_entry_cycle'
    -#
      %tr
        %th{ :colspan => "30" }
    %h2.landing
      This Past Week
    .clear
    .list.row-listing.pages
      - week.each do |page|
        = render :partial => 'pages/list/activity_entry', :locals => {:page => page, :style => style}

-#
  - if later.any?
  - reset_cycle 'activity_entry_cycle'
  %tr
    %th{ :colspan => "30" }
      %h4.landing
        Earlier
  - later.each do |page|
  = render :partial => 'pages/list/activity_entry', :locals => {:page => page, :style => style}
  - end
  - end
